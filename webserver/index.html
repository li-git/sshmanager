<html>
<body>
<div align="center">
    <table border=10 id="tablelist">
        <tr>
            <td>server ip</td>
            <td>cpu cores</td>
            <td>username</td>
            <td>owner</td>
            <td>endtime</td>
            <td>apply</td>
        </tr>
    </table>
    <br>
    <label>username:</label>
    <input id="username"></input>
    <label>password:</label>
    <input id="password"></input>
    <label>endtime:</label>
    <input id="time" type="datetime-local"></input>
<div>
<script src="http://libs.baidu.com/jquery/2.1.4/jquery.min.js"></script>
<script>
//var newRow = "<tr><td>0.0.0.0</td><td>40</td><td>username</td><td>name</td><td>2020-1-1</td></tr>";
//$("#tablelist tr:last").after(newRow);
$.ajax({
    url: '/serverList',
    type: 'GET',
    success: function(response) {
        var obj = $.parseJSON(response);
        for(var i in obj){
            var newRow = "<tr>"
            newRow = newRow + "<td>" + obj[i].Host + "</td>"
            newRow = newRow + "<td>" + obj[i].Cpus + "</td>"
            newRow = newRow + "<td>" + obj[i].Username + "</td>"
            newRow = newRow + "<td>" + obj[i].Ower + "</td>"
            newRow = newRow + "<td>" + obj[i].Endtime + "</td>"
            newRow = newRow + "<td><button>"+obj[i].Host+"</button></td>"
            newRow += "</tr>"
            $("#tablelist tr:last").after(newRow);
        }
    }
});
$(document).ready(function(){
    $("table").on("click", "button", function(){
        var username = $("#username").val()
        var password = $("#password").val()
        var data = {}
        data.server = $(this).text()
        data.user = username
        data.pass = password
        data.time = $("#time").val()
        var post = JSON.stringify(data)
        $.ajax({
            url: '/apply',
            type: 'POST',
            data: post,
            success: function(response) {
                var rep = $.parseJSON(response)
                if(rep.result=="success"){
                    alert("apply success!")
                }else{
                    alert("apply failed!")
                }
            }
        });
    });
})

</script>
</body>
